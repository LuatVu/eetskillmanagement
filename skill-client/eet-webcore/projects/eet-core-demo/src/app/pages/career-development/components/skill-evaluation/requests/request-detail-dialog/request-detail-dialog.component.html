<eet-common-dialog>
  <div dialog-content class="content">
    <div class="title-wrapper" fxLayout="row wrap" fxLayoutAlign="space-between" fxLayoutGap="8px">
      <div fxLayout="row" *ngIf="!isEdited">
        <p class="dialog-title bold">{{ "Requester" | translate }}:</p>
        <p class="blue bold">{{skillData.requester}}</p>
      </div>
      <div fxLayout="row">
        <p class="dialog-title bold">{{ "Approver" | translate }}:</p>
        <p class="blue bold">{{skillData.approver}}</p>
      </div>

      <mat-form-field class="search-box" *ngIf="isEdited">
        <mat-label>{{ "skill.title.search_bar" | translate }}</mat-label>
        <input matInput (keyup)="applyFilter($event)" #input />
        <button type="submit" class="a-text-field__icon-search" matSuffix (keyup)="applyFilter($event)">
          <i class="a-icon ui-ic-search"></i>
        </button>
      </mat-form-field>
    </div>

    
    <hr class="a-divider" />
    <table mat-table [dataSource]="dataSource" class="skill-table table-common skill-table-header" matSort>
      <!-- Skill -->

      <ng-container matColumnDef="skill">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>
          {{ "skill.title.skill" | translate }}
        </th>

        <td mat-cell *matCellDef="let element">
          <div class="w-130" [matTooltip]="c && c.scrollHeight>45? element.skill:''" #skill>
          <mat-icon class="mat-icon" matTooltip="View Skill Detail" fontIcon="bosch-ic-alert-info-filled" (click)="onViewDetail(element)">
          </mat-icon>
            {{ element.skill || '--' }}
          </div>
        </td>
      </ng-container>

      <!-- Skill Group -->
      <ng-container matColumnDef="skill_group">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>
          {{ "skill.title.skill_cluster" | translate }}
        </th>
        <td mat-cell *matCellDef="let element">{{ element.skill_group }}</td>
      </ng-container>
      <!-- Evaluated Level -->
      <ng-container matColumnDef="current_level">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>
          {{ "skill.title.evaluate_level" | translate }}
        </th>

        <td mat-cell *matCellDef="let element" class="select-box"
          [ngClass]="onCheckUpdated(element.current_level, element.old_level)">
          <mat-select *ngIf="isEdited" [(ngModel)]="element.current_level" [disabled]="element.isDisabled">
            <ng-container *ngIf="element.skill_type === 'Technical'">
              <mat-option *ngFor="let op of technicalLevelList" [value]="op" class="filter">
                {{ op }}
              </mat-option>
            </ng-container>
            <ng-container *ngIf="element.skill_type === 'Behavioral'">
              <mat-option *ngFor="let op of behavioralLevelList" [value]="op" class="filter">
                {{ op }}
              </mat-option>
            </ng-container>
          </mat-select>
          <p class="center current-level" *ngIf="!isEdited">{{ element.current_level || '--'}}</p>
        </td>
      </ng-container>
      <!-- Current Level -->
      <ng-container matColumnDef="old_level">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>
          {{ "skill.title.current_level" | translate }}
        </th>

        <td mat-cell *matCellDef="let element" [ngStyle]="{'color':buildColor_CurrentLevel(element)}">
          <p class="center expected-level">{{element.old_level || '--'}}</p>
        </td>
      </ng-container>

      <!-- Expected Level -->
      <ng-container matColumnDef="expected_level">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>
          {{ "skill.title.expect_level" | translate }}
        </th>

        <td mat-cell *matCellDef="let element">
          <p class="center expected-level">{{element.expected_level || '--'}}</p>
        </td>
      </ng-container>

      <!-- Experience -->
      <ng-container matColumnDef="current_experience">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>
          {{ "skill.title.exp" | translate }}
        </th>
        <td mat-cell *matCellDef="let element" class="select-box"
          [ngClass]="onCheckUpdated(element.current_experience, element.old_experience)">
          <mat-select *ngIf="isEdited" [(ngModel)]="element.current_experience" [disabled]="element.isDisabled">
            <mat-option *ngFor="let op of experienceList; index as i" [value]="i" class="filter">
              {{ op }}
            </mat-option>
          </mat-select>
          <ng-container *ngIf="!isEdited">
            <p class="center current-level" *ngIf="!isEdited"
              [ngClass]="onCheckUpdated(element.current_experience, element.old_experience)"> {{
              experienceList[element.current_experience] || '--'}}
            </p>
          </ng-container>
        </td>
      </ng-container>

      <!-- Approver Comment -->
      <ng-container matColumnDef="approver_comment">
        <th mat-header-cell *matHeaderCellDef>
          {{ "skill.title.approver_comment" | translate }}
        </th>
        <td mat-cell *matCellDef="let element">
          <div mat-label matTooltip="{{element.approver_comment}}"  class="limit-height-box limit-height-box__comment"
          [matTooltip]="comment && comment.scrollHeight> 34? element.approver_comment:''" #comment>
            {{ element?.approver_comment || '--'}}
          </div>
        </td>
      </ng-container>

      <!-- Associate Comment -->
      <ng-container matColumnDef="comment">
        <th mat-header-cell *matHeaderCellDef>
          {{ "skill.title.comment" | translate }}
        </th>
        <td mat-cell *matCellDef="let element">
          <mat-form-field *ngIf="isEdited" floatLabel="never" style="padding: 0;">
            <textarea (keyup)="onResize($event)" matInput [(ngModel)]="element.comment" [value]="element.comment"
              [disabled]="element.isDisabled" placeholder="{{element.comment || ''}}"></textarea>
          </mat-form-field>
          <ng-container *ngIf="!isEdited">
            <p mat-label matTooltip="{{element.comment}}" class="comment-box">{{ element.comment || '--'}}</p>
          </ng-container>
        </td>
      </ng-container>

      <!-- isApproved -->
      <ng-container matColumnDef="status">
        <th mat-header-cell *matHeaderCellDef>
          {{ "manage_request.dialog.check_approval" | translate }}
        </th>
        <td mat-cell *matCellDef="let element" [ngClass]="{'waiting': element.status === 'APPROVAL_PENDING',
        'approve': element.status === 'APPROVED',
        'reject': element.status === 'REJECTED'
    }">
          {{ status.get(element.status) }}
        </td>
      </ng-container>

      <!-- Approved By -->
      <ng-container matColumnDef="competency_lead">
        <th mat-header-cell *matHeaderCellDef>
          {{ "manage_request.dialog.approved_by" | translate }}
        </th>
        <td mat-cell *matCellDef="let element">
          <div class="limit-height-box" [matTooltip]="element.competency_lead && element.competency_lead.scrollHeight> 34? 
            element.competency_lead.display_name:''" #competency_lead>
            {{ element.competency_lead.display_name }}
          </div>
        </td>
      </ng-container>

      <!-- Filter -->
      <ng-container>
        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
        <tr class="mat-row" *matNoDataRow>
          <td class="mat-cell" colspan="8">
            {{ "skill.message.no_match" | translate }}
          </td>
        </tr>
      </ng-container>
    </table>

    <!-- Pagination -->
    <ng-container *ngIf="isNotFromDialog === true">
      <div fxLayout="row" fxLayoutAlign="center none">
        <mat-paginator #paginator [pageSizeOptions]="pageOptions" showFirstLastButtons></mat-paginator>
      </div>
    </ng-container>

    <hr *ngIf="!isEdited" class="a-divider" />

    <div class="manager-comment" *ngIf="!isEdited" fxLayout="column">
      <p class="bold">{{ "skill.title.approver_comment" | translate }}</p>
      <div class="comments" fxLayout="row" fxLayoutGap="2%">
        <div class="avatar" *ngIf="personalInfo">
          <div class="circles" *ngIf="personalInfo.name" [style.color]="avatarcolor"
            [ngStyle]="{ 'background-color': avatarbgcolor }">
            <div class="image-cropper" *ngIf="showavatar == false">
              <img [src]="'data:image/jpeg;base64,' + imageToShow" alt="" class="img" [style.color]="avatarcolor"
                [ngStyle]="{ 'background-color': avatarbgcolor }" />
            </div>
            <div class="shortname" *ngIf="showshortname == false">
              {{ newshortname }}
            </div>
            <button class="mat-icon-button gallery-button" *ngIf="associate == false || associatemanager == false">
              <mat-icon svgIcon="upload"></mat-icon>
            </button>
          </div>
        </div>
        <div class="manager-wrapper">
          <p class="bold">{{skillData.approver}} {{ (skillData.updated_date ? ('(' + skillData.updated_date + ')') :
            '')}}</p>
          <p class="manager-comment">
            {{skillData.comment}}
          </p>
        </div>
      </div>
    </div>


  </div>
  <div dialog-action class="action-wrapper" fxLayout="row" fxLayoutGap="1.5rem" fxLayoutAlign="end">
    <button *ngIf="isEdited" type="button" class="a-button a-button--primary -without-icon btn-login"
      (click)="onEvaluate()">
      <div class="a-button__label txt-label">
        {{ "skill.button.dialog.save" | translate }}
      </div>
    </button>
  </div>
</eet-common-dialog>