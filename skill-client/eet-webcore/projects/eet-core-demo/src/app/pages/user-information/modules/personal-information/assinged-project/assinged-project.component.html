<div class="LearningCompoment">
  <div class="box-search">
    <div>
      <button type="button" class="a-button a-button--primary" matTooltipClass="matTooltip" matTooltip="{{
          (typeUser == 'Associate' ? 'personal_information.assign_project.dialog.bosch_project.title' :
          'personal_information.assign_project.dialog.non_bosch_project.title')
          | translate}}" *ngIf="isEditMode" (click)="openDialogAddBoschProject()">
        <i class="a-icon a-button__icon ui-ic-plus" title="alert-success"></i>
        <span class="a-button__label">{{
          (typeUser == 'Associate' ? 'personal_information.assign_project.dialog.bosch_project.title' :
          'personal_information.assign_project.dialog.non_bosch_project.title')
          | translate}}</span>
      </button>
    </div>
    <mat-form-field class="search-box">
      <mat-label>{{ "personal_information.project_search" | translate }}</mat-label>
      <input [(ngModel)]="searchedWord" matInput (keyup)="applyFilter()"  #input />
      <button type="submit" class="a-text-field__icon-search" matSuffix (keyup)="applyFilter()">
        <i class="a-icon ui-ic-search"></i>
      </button>
    </mat-form-field>
  </div>
  <div fxLayout="row" class="ProjectTable">
    <table mat-table [dataSource]="dataSource" multiTemplateDataRows class="table-common full-width" matSort>
      <ng-container matColumnDef="Project">
        <th mat-header-cell *matHeaderCellDef mat-sort-header="Project">{{'personal_project.name' | translate}}</th>
        <td mat-cell *matCellDef="let element">{{element.name.length < 20 ? element.name : element.name.substr(0, 17) + '...'}}</td>
      </ng-container>
      <ng-container matColumnDef="ProjectType">
        <th mat-header-cell *matHeaderCellDef mat-sort-header="ProjectType">{{'personal_project.type' | translate}}</th>
        <td mat-cell *matCellDef="let element">{{element.project_type}}</td>
      </ng-container>
      <ng-container matColumnDef="Role">
        <th mat-header-cell *matHeaderCellDef mat-sort-header="Role">{{'personal_project.role' | translate}}</th>
        <td mat-cell *matCellDef="let element">{{element.role_name}}</td>
      </ng-container>
      <ng-container matColumnDef="TeamSize">
        <th mat-header-cell *matHeaderCellDef mat-sort-header="TeamSize">{{'personal_project.size' | translate}}</th>
        <td mat-cell *matCellDef="let element">{{element.team_size}}</td>
      </ng-container>
      <ng-container matColumnDef="StartDate">
        <th mat-header-cell *matHeaderCellDef mat-sort-header="StartDate">{{'personal_project.start_date' | translate}}</th>
        <td mat-cell *matCellDef="let element">{{element.member_start_date | date : 'dd/MM/yyyy'}}</td>
      </ng-container>
      <ng-container matColumnDef="EndDate">
        <th mat-header-cell *matHeaderCellDef mat-sort-header="EndDate">{{'personal_project.end_date' | translate}}</th>
        <td mat-cell *matCellDef="let element">{{element.member_end_date | date : 'dd/MM/yyyy'}}</td>
      </ng-container>
      <ng-container matColumnDef="Status">
        <th mat-header-cell *matHeaderCellDef mat-sort-header="Status">{{'personal_project.status' | translate}}</th>
        <td mat-cell *matCellDef="let element" [ngClass]="{           
            'On-going' : element.status =='On-going',     
            'Closed' : element.status == 'Closed'
         }">{{element.status}}</td>
      </ng-container>
      <ng-container matColumnDef="Action">
        <th mat-header-cell *matHeaderCellDef>{{'personal_project.action' | translate}}</th>
        <td mat-cell *matCellDef="let element" class="table-action">
          <ng-container>
            <button mat-icon-button (click)="onViewProject(element)">
              <i class="a-icon ui-ic-watch-on"></i>
            </button>
            <button mat-icon-button (click)="removeSelectedRows(element.id)" *ngIf="isEditMode && isDeleteAllowed(element.project_type)">
              <i class="a-icon boschicon-bosch-ic-delete"></i>
            </button>
            <button mat-icon-button [disabled]="true" *ngIf="isEditMode && !isDeleteAllowed(element.project_type)">
              <i class="a-icon boschicon-bosch-ic-delete icon-disabled"></i>
            </button>
            <button mat-icon-button (click)="onEditProject(element)" *ngIf="isEditMode">
              <i class="a-icon boschicon-bosch-ic-edit"></i>
            </button>
          </ng-container>
        </td>
      </ng-container>
      <ng-container matColumnDef="expandedDetail">
        <td mat-cell *matCellDef="let element" [attr.colspan]="columnsToDisplayWithExpand.length">
          <div class="element-detail" [@detailExpand]="(element?.project_id == expandedElement?.project_id || element?.id == expandedElement?.id) ? 'expanded' : 'collapsed'
            ">
            <eet-project-info [isDisable]="isEditMode" [typeUser]="typeUser" [isEditMode]="isEditMode"
              [isExpand]="element?.project_id == expandedElement?.project_id || element?.id == expandedElement?.id "
              [projectId]="element?.id"
              *ngIf="element?.project_id == expandedElement?.project_id || element?.id == expandedElement?.id "
              [selectedProject]="element" (onSaveChange)="onProjectSave($event, element)"></eet-project-info>
          </div>
        </td>
      </ng-container>
      <tr mat-header-row *matHeaderRowDef="columnsToDisplayWithExpand"></tr>
      <tr mat-row *matRowDef="let element; columns: columnsToDisplayWithExpand;" class="expanded"
        [class.expanded-row]="element?.project_id == expandedElement?.project_id || element?.id == expandedElement?.id">
      </tr>
      <tr mat-row *matRowDef="let row; columns: ['expandedDetail']" class="detail-row"></tr>
      <tr class="mat-row" *matNoDataRow>
        <td class="mat-cell" colspan="8" style="text-align: center;">
          Nodata
        </td>
      </tr>
    </table>
  </div>
</div>